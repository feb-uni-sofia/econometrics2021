---
title: "Week4"
author: "Boyko Amarov"
date: "3/30/2021"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
invoices <- read.delim('https://raw.githubusercontent.com/feb-uni-sofia/econometrics2020-solutions/master/data/invoices.txt')
```


```{r}
glimpse(invoices)
```

Описание:

- `Day` (numeric): дни
- `Invoices` (numeric): брой фактури
- `Time` (numeric): Време за обработка на фактурите (часове)

Task is to predict the time needed to process 50, 120, 200, 250 invoices.

```{r}
summary(invoices$Time)
```


```{r}
ggplot(data = invoices, aes(x = Invoices, y = Time)) + 
  geom_point() +
  geom_vline(xintercept = c(80, 250), lty = 2, alpha = 0.3) +
  geom_vline(xintercept = 120, lty = 2) +
  geom_hline(yintercept = 2.110) + 
  labs(
    x = "Брой фактури",
    y = "Време за обработка (часове)"
  ) + 
  geom_abline(intercept = 0.1, slope = 0.015, colour = "steelblue2")
```

Estimate the expected processing time for 80, 120 and 250 invoices (3 estimates).

Strategy 1: Use the average processing time for the predictions


$$
i = 1,\ldots,n = 30\\
x_i: \text{ брой фактури в ден } i \\
y_i: \text{ време за обработка в ден } i \\
$$


$$
y_{x = 80} = 0.1 + 0.015 \times 80 = 1.3 [часа]
$$



## Мерни единици на коефициенти

$$
y[\text{часове}] = 0.1[\text{часове}] + \underbrace{0.015[\frac{\text{часове}}{фактура}]x[\text{брой фактури}]}_{\text{часове}}\\
x = 0 \implies y[\text{часове}] = 0.1[\text{часове}]
$$

<!-- $$ -->
<!-- \text{стая } 50 [m^2]\\ -->
<!-- \text{ наем } 2[\frac{лв.}{m^2}] \\ -->
<!-- 50[m^2] \times 2[\frac{лв.}{m^2}] = 100 [лв.] -->
<!-- $$ -->


$$
y[разходи] = 0.1[\text{фикс. разх.}] + 0.015[\text{пределни разходи/marginal costs}]x
$$

$$
y = \underbrace{0.1}_{Intercept} + \underbrace{0.015}_{slope/налкон}x\\
y_{x = 0} = 0.1
$$


$$
y = \underbrace{0.1}_{\text{intercept}} + \underbrace{0.015}_{\text{slope}}x
$$
$$
y = \underbrace{0.01 + 0.015x}_{права} + \underbrace{e_i}_{отклонение}
$$
$e_i$: случайна променлива (резултат от игра).

```{r}
## r (random, случайно), unif (uniform, равномерно)
x <- runif(10, min = -1, max = 1)
mean(x)
x
```


$$
y_{x = 80} = \underbrace{0.01 + 0.015 \times 80}_{\text{права/систематична част}} + \underbrace{e_i}_{отклонение}  = \\
\underbrace{1.3}_{права} + \underbrace{e_i}_{\text{отклонение/грешка/шум/стохастична (случайна) час}}
$$

## Очакване на случайна променлива (разпределение)

Допускане: средното на отклоненията е нула.

$$
E(e_i) = 0 \text{ допускане}\\
E(y_i) = E(0.1 + 0.015x + e_i) = \\
E(0.1) + E(0.015x) + \underbrace{E(e_i)}_{=0} \\
E(y_i) = 0.1 + 0.15x_i
$$

$$
y_i = 0.1 + 0.015x + e_i
$$














$$
y_i  = \underbrace{0.1 + 0.015x_i}_{\text{line, systematic part}} + \underbrace{e_i}_{\text{deviation from the line, stochastic (random) part}}
$$
```{r}
x <- 190
line_part <- 0.1 + 0.015 * x
deviation_part <- runif(1, min = -1, max = 1)
deviation_part
y <- line_part + deviation_part
y
```

```{r}
rand_numbers <- runif(10000, min = -1, max = 1)
# rand_numbers
mean(rand_numbers)
```
